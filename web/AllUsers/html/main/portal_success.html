<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet"  href='../../../resource/common/<%HW_WEB_CleanCache_Resource(style.css);%>' type='text/css'>
<link rel="stylesheet"  href='../../../Cuscss/<%HW_WEB_GetCusSource(frame.css);%>' type='text/css'>
<script language="JavaScript" src="../../../resource/<%HW_WEB_Resource(ssmpdes.js);%>"></script>
<script language="JavaScript" src="../../../resource/common/util.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<title>Success</title>
<style type="text/css">

.li_comm {
	height:24px;
}

.li_msg {
	height:auto;
}

.prompt_head {
    border: #c5d8e6 1px solid;
    /* background-color: #feffe0; */
    padding: 10px;
    font-family: "微软雅黑";
    /* color: #ECA417; */
    font-size: 14px;
    height: 35px;
}

.prompt_body {
    border: #c5d8e6 1px solid;
    /* background-color: #feffe0; */
    padding: 10px;
    font-family: "微软雅黑";
    /* color: #ECA417; */
    font-size: 14px;
    height: 35px;
}

</style>
<script language="JavaScript" type="text/javascript">

function BponPortalUserImportResult(domain, AddSuccNum, UpdateSuccNum, FailNum) {
	this.domain = domain;
	this.AddSuccNum = AddSuccNum;
	this.UpdateSuccNum = UpdateSuccNum;
	this.FailNum = FailNum;
}

var USER_RESULT = <%HW_WEB_GetParaArryByDomain(InternetGatewayDevice.Services.X_HW_BponPortal.LoadUserImport.{i}, AddSuccNum|UpdateSuccNum|FailNum, BponPortalUserImportResult);%>;
var UserResult = new Array();
var UserImportNum = 0;

for (var i = 0; i < USER_RESULT.length - 1; i++) {
	UserResult[UserImportNum] = USER_RESULT[i];
	UserImportNum++;
}

function htmlEncode(str)
{
    var ret = "";
    if (str.length == 0) {
        return "";
    }
    ret = str.replace(/&/g, "&amp;");
    ret = ret.replace(/</g, "&lt;");
    ret = ret.replace(/>/g, "&gt;");
    ret = ret.replace(/ /g, "&nbsp;");
    ret = ret.replace(/\'/g, "&#39;");
    ret = ret.replace(/\"/g, "&quot;");
    ret = ret.replace(/\n/g, "<br/>");
    ret = ret.replace(/\(/g, "&#40;");
    ret = ret.replace(/\)/g, "&#41;");
    return ret;
}

function BponPortalUserImportFailUserName(domain,UserName) {
	this.domain = domain;
	this.UserName = UserName;
}
var USERFAILNAME_RESULT = <%HW_WEB_GetParaArryByDomain(InternetGatewayDevice.Services.X_HW_BponPortal.FailUserName.{i}, UserName, BponPortalUserImportFailUserName);%>;
var UserFailName = new Array();
var UserFailNameNum = 0;

for (var i = 0; i < USERFAILNAME_RESULT.length - 1; i++) {
    UserFailName[UserFailNameNum] = USERFAILNAME_RESULT[i];
    UserFailName[UserFailNameNum].UserName = htmlEncode(USERFAILNAME_RESULT[i].UserName);
    UserFailNameNum++;
}

</script>
</head>
<body class="mainbody"> 
    <div> 
      <table width="100%" height="10%" border="0" cellspacing="0" cellpadding="0"> 
        <tr> 
          <td class="prompt_head" style="text-align: center;"><table width="100%" border="0" cellspacing="0" cellpadding="0"> 
              <tr> 
				<img src="../../../images/ok.gif" width="25" height="25" /><span style="font-size: 20px;">&nbsp;批量导入本地认证参数完成</span>
              </tr> 
            </table></td> 
        </tr> 
      </table> 
    </div> 
	<div> 
      <table width="100%" height="10%" border="0" cellspacing="0" cellpadding="0"> 
        <tr> 
          <td class="prompt_body"><table width="100%" border="0" cellspacing="0" cellpadding="0"> 
			  <tr>
				<script language="JavaScript" type="text/javascript">
					document.write('<li class="li_comm">新增认证参数：' + UserResult[0].AddSuccNum + '条</li>');
					document.write('<li class="li_comm">修改认证参数：' + UserResult[0].UpdateSuccNum + '条</li>');
					document.write('<li class="li_comm">失败认证参数：' + UserResult[0].FailNum + '条</li>');
					if (UserResult[0].FailNum != 0) {
					  document.write('<li class="li_msg">失败认证参数的用户名信息如下：</br>');
          }
					for (var index = 0; index < UserFailNameNum; index++) {
						document.write(UserFailName[index].UserName + ', ');
					}
					document.write('</li>');
                </script>
			  </tr>
            </table></td> 
        </tr> 
      </table> 
    </div> 
</body>
</html>
